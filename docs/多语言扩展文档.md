# ZFX 支付中心系统 - 多语言扩展文档

## 1. 概述

ZFX 支付中心系统现已实现完整的多语言国际化功能，采用**英文优先**的架构设计。当前支持的语言：
- 🇺🇸 **English** (默认语言，系统主语言)
- 🇨🇳 **简体中文** (完整翻译支持)

> **注意**: 系统采用英文优先的国际化架构，所有数据库主键、菜单标识符、用户信息等均使用英文，中文作为扩展语言提供翻译。

## 2. 技术架构

### 2.1 前端国际化架构

```
src/i18n/
├── index.js                    # 国际化主配置文件
└── lang/                       # 语言文件目录
    ├── en-US/index.js         # 英文语言包
    ├── zh-CN/index.js         # 中文语言包
    ├── fr-FR/index.js         # 法语语言包
    ├── es-ES/index.js         # 西班牙语语言包
    └── pt-PT/index.js         # 葡萄牙语语言包
```

### 2.2 后端国际化架构

```
src/main/resources/i18n/
├── messages.properties         # 默认英文消息
├── messages_zh_CN.properties  # 中文消息
├── messages_fr_FR.properties  # 法语消息
├── messages_es_ES.properties  # 西班牙语消息
└── messages_pt_PT.properties  # 葡萄牙语消息
```

### 2.3 数据库架构

```sql
-- 多语言配置表
t_i18n_language
├── id (主键)
├── language_code (语言代码)
├── language_name (语言名称)
├── native_name (本地语言名称)
├── flag_emoji (国旗表情符号)
├── is_default (是否默认语言)
├── sort_order (排序)
└── status (状态)

-- 多语言消息表
t_i18n_message
├── id (主键)
├── message_key (消息键)
├── language_code (语言代码)
├── message_value (消息值)
├── category (分类)
└── module (模块)
```

## 3. 功能特性

### 3.1 前端功能

#### 3.1.1 语言切换组件
- **位置**: 系统头部导航栏
- **功能**: 下拉选择语言，实时切换
- **特性**: 
  - 显示国旗图标
  - 当前语言高亮显示
  - 切换后自动刷新页面

#### 3.1.2 语言包结构
```javascript
// 语言包示例 (英文)
export default {
  antdLocale: antd,           // Ant Design 组件国际化
  dayjsLocale: dayjs,         // 日期组件国际化
  'setting.title': 'Setting', // 系统设置相关
  'common.login': 'Login',    // 通用操作
  'payment.order.title': 'Payment Order Management', // 业务模块
  'status.enable': 'Enable',  // 状态枚举
}
```

### 3.2 后端功能

#### 3.2.1 消息国际化
- 支持Spring Boot原生国际化
- 基于properties文件的键值对翻译
- 支持参数化消息模板

#### 3.2.2 数据库多语言支持
- 动态语言配置管理
- 支持运行时添加新语言
- 消息分类和模块化管理

## 4. 使用方法

### 4.1 前端使用

#### 4.1.1 在Vue组件中使用
```vue
<template>
  <div>
    <h1>{{ $t('payment.order.title') }}</h1>
    <button>{{ $t('common.submit') }}</button>
  </div>
</template>

<script>
import { useI18n } from 'vue-i18n';

export default {
  setup() {
    const { t } = useI18n();
    
    const title = t('payment.order.title');
    
    return {
      title
    };
  }
};
</script>
```

#### 4.1.2 在JavaScript中使用
```javascript
import { useI18n } from 'vue-i18n';

const { t } = useI18n();
const message = t('common.login');
```

### 4.2 后端使用

#### 4.2.1 在Controller中使用
```java
@RestController
public class PaymentController {
    
    @Autowired
    private MessageSource messageSource;
    
    @GetMapping("/payment/orders")
    public ResponseEntity<?> getOrders(Locale locale) {
        String title = messageSource.getMessage("payment.order.title", null, locale);
        // ...
    }
}
```

#### 4.2.2 在Service中使用
```java
@Service
public class PaymentService {
    
    @Autowired
    private MessageSource messageSource;
    
    public String getMessage(String key, Locale locale) {
        return messageSource.getMessage(key, null, locale);
    }
}
```

## 5. 配置说明

### 5.1 前端配置

#### 5.1.1 添加新语言
1. 在 `src/i18n/lang/` 目录下创建新语言文件夹
2. 创建 `index.js` 文件，定义语言包
3. 在 `src/i18n/index.js` 中导入并注册新语言

```javascript
// 示例：添加德语支持
import de_DE from './lang/de-DE/index';

export const i18nList = [
  // ... 现有语言
  {
    text: 'Deutsch',
    value: 'de_DE',
    flag: '🇩🇪',
  },
];

export const messages = {
  // ... 现有消息
  de_DE: de_DE,
};
```

#### 5.1.2 修改默认语言
```javascript
// src/config/app-config.js
export const appDefaultConfig = {
  language: 'en_US', // 修改为需要的默认语言
  // ...
};
```

### 5.2 后端配置

#### 5.2.1 Spring Boot配置
```yaml
# application.yml
spring:
  messages:
    basename: i18n/messages
    encoding: UTF-8
    cache-duration: 3600
```

#### 5.2.2 添加新语言消息
1. 在 `src/main/resources/i18n/` 目录下创建新的properties文件
2. 添加对应的消息键值对
3. 重启应用生效

## 6. 数据库管理

### 6.1 语言配置管理

```sql
-- 添加新语言
INSERT INTO t_i18n_language (language_code, language_name, native_name, flag_emoji, sort_order, status) 
VALUES ('de_DE', 'German', 'Deutsch', '🇩🇪', 6, 1);

-- 更新语言状态
UPDATE t_i18n_language SET status = 0 WHERE language_code = 'pt_PT';

-- 查询所有启用的语言
SELECT * FROM t_i18n_language WHERE status = 1 ORDER BY sort_order;
```

### 6.2 消息管理

```sql
-- 添加新消息
INSERT INTO t_i18n_message (message_key, language_code, message_value, category, module) 
VALUES ('common.new', 'en_US', 'New', 'common', 'system');

-- 批量添加多语言消息
INSERT INTO t_i18n_message (message_key, language_code, message_value, category, module) VALUES
('common.new', 'en_US', 'New', 'common', 'system'),
('common.new', 'zh_CN', '新建', 'common', 'system'),
('common.new', 'fr_FR', 'Nouveau', 'common', 'system');

-- 查询特定分类的消息
SELECT * FROM t_i18n_message WHERE category = 'payment' AND language_code = 'en_US';
```

## 7. 最佳实践

### 7.1 命名规范

#### 7.1.1 消息键命名
```
格式: {模块}.{功能}.{元素}

示例:
- common.login          # 通用登录
- payment.order.title   # 支付订单标题
- merchant.form.name    # 商户表单名称
- status.enable         # 状态启用
```

#### 7.1.2 分类管理
- **common**: 通用操作 (登录、退出、保存等)
- **payment**: 支付相关
- **merchant**: 商户管理
- **status**: 状态枚举
- **system**: 系统消息

### 7.2 翻译原则

1. **一致性**: 相同概念在不同位置使用相同翻译
2. **简洁性**: 翻译要简洁明了，避免冗长
3. **准确性**: 确保翻译准确传达原意
4. **本地化**: 考虑目标语言的文化背景

### 7.3 性能优化

1. **懒加载**: 按需加载语言包
2. **缓存**: 缓存翻译结果
3. **压缩**: 压缩语言包文件
4. **CDN**: 使用CDN分发语言文件

## 8. 故障排除

### 8.1 常见问题

#### 8.1.1 语言切换不生效
**原因**: 浏览器缓存或配置问题
**解决**: 
1. 清除浏览器缓存
2. 检查语言包是否正确导入
3. 确认语言代码格式正确

#### 8.1.2 部分文本未翻译
**原因**: 缺少对应的翻译键
**解决**:
1. 检查语言包是否包含对应键值
2. 确认键名拼写正确
3. 添加缺失的翻译

#### 8.1.3 日期格式不正确
**原因**: dayjs语言包配置问题
**解决**:
1. 确认dayjs语言包正确导入
2. 检查语言代码格式
3. 重新配置dayjs locale

### 8.2 调试方法

#### 8.2.1 前端调试
```javascript
// 检查当前语言
console.log($i18n.locale.value);

// 检查翻译键是否存在
console.log($i18n.te('common.login'));

// 获取所有可用语言
console.log($i18n.availableLocales);
```

#### 8.2.2 后端调试
```java
// 检查当前语言环境
Locale currentLocale = LocaleContextHolder.getLocale();
System.out.println("Current locale: " + currentLocale);

// 检查消息是否存在
try {
    String message = messageSource.getMessage("common.login", null, locale);
    System.out.println("Message: " + message);
} catch (NoSuchMessageException e) {
    System.out.println("Message not found: " + e.getMessage());
}
```

## 9. 扩展计划

### 9.1 短期计划
- [ ] 添加更多欧洲语言支持
- [ ] 完善业务模块翻译
- [ ] 优化语言切换体验
- [ ] 添加RTL语言支持

### 9.2 长期计划
- [ ] 动态语言包加载
- [ ] 在线翻译管理界面
- [ ] 自动翻译集成
- [ ] 语言使用统计分析

## 10. 相关资源

### 10.1 官方文档
- [Vue I18n 官方文档](https://vue-i18n.intlify.dev/)
- [Spring Boot 国际化](https://spring.io/guides/gs/spring-boot/)
- [Ant Design Vue 国际化](https://antdv.com/docs/vue/i18n-cn)

### 10.2 工具推荐
- [i18next](https://www.i18next.com/) - 国际化框架
- [Lokalise](https://lokalise.com/) - 翻译管理平台
- [Google Translate API](https://cloud.google.com/translate) - 自动翻译服务

---

**文档版本**: v1.0  
**创建日期**: 2024-09-29  
**更新日期**: 2024-09-29  
**创建人**: AI Assistant  
**审核人**: 待定
